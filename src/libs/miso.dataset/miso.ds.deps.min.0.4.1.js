/**
* Miso.Dataset - v0.4.1 - 6/24/2014
* http://github.com/misoproject/dataset
* Copyright (c) 2014 Alex Graul, Irene Ros;
* Dual Licensed: MIT, GPL
* https://github.com/misoproject/dataset/blob/master/LICENSE-MIT 
* https://github.com/misoproject/dataset/blob/master/LICENSE-GPL 
*/
(function(t){function e(t,e,n,i){var r=n.lang();return r[t].call?r[t](n,i):r[t][e]}function n(t,e){return function(n){return a(t.call(this,n),e)}}function i(t){return function(e){var n=t.call(this,e);return n+this.lang().ordinal(n)}}function r(t,e,n){this._d=t,this._isUTC=!!e,this._a=t._a||null,this._lang=n||!1}function s(t){var e=this._data={},n=t.years||t.y||0,i=t.months||t.M||0,r=t.weeks||t.w||0,s=t.days||t.d||0,a=t.hours||t.h||0,u=t.minutes||t.m||0,c=t.seconds||t.s||0,h=t.milliseconds||t.ms||0;this._milliseconds=h+1e3*c+6e4*u+36e5*a,this._days=s+7*r,this._months=i+12*n,e.milliseconds=h%1e3,c+=o(h/1e3),e.seconds=c%60,u+=o(c/60),e.minutes=u%60,a+=o(u/60),e.hours=a%24,s+=o(a/24),s+=7*r,e.days=s%30,i+=o(s/30),e.months=i%12,n+=o(i/12),e.years=n,this._lang=!1}function o(t){return 0>t?Math.ceil(t):Math.floor(t)}function a(t,e){for(var n=t+"";e>n.length;)n="0"+n;return n}function u(t,e,n){var i,r=e._milliseconds,s=e._days,o=e._months;r&&t._d.setTime(+t+r*n),s&&t.date(t.date()+s*n),o&&(i=t.date(),t.date(1).month(t.month()+o*n).date(Math.min(i,t.daysInMonth())))}function c(t){return"[object Array]"===Object.prototype.toString.call(t)}function h(t,e){var n,i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0;for(n=0;i>n;n++)~~t[n]!==~~e[n]&&s++;return s+r}function l(t,e,n,i){var r,s,o=[];for(r=0;7>r;r++)o[r]=t[r]=null==t[r]?2===r?1:0:t[r];return t[7]=o[7]=e,null!=t[8]&&(o[8]=t[8]),t[3]+=n||0,t[4]+=i||0,s=new Date(0),e?(s.setUTCFullYear(t[0],t[1],t[2]),s.setUTCHours(t[3],t[4],t[5],t[6])):(s.setFullYear(t[0],t[1],t[2]),s.setHours(t[3],t[4],t[5],t[6])),s._a=o,s}function d(t,e){var n,i,r=[];for(!e&&E&&(e=require("./lang/"+t)),n=0;T.length>n;n++)e[T[n]]=e[T[n]]||k.en[T[n]];for(n=0;12>n;n++)i=moment([2e3,n]),r[n]=RegExp("^"+(e.months[n]||e.months(i,""))+"|^"+(e.monthsShort[n]||e.monthsShort(i,"")).replace(".",""),"i");return e.monthsParse=e.monthsParse||r,k[t]=e,e}function f(t){var e="string"==typeof t&&t||t&&t._lang||null;return e?k[e]||d(e):moment}function p(t){return t.match(/\[.*\]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function m(t){var e,n,i=t.match(O);for(e=0,n=i.length;n>e;e++)i[e]=te[i[e]]?te[i[e]]:p(i[e]);return function(r){var s="";for(e=0;n>e;e++)s+="function"==typeof i[e].call?i[e].call(r,t):i[e];return s}}function y(t,e){function n(e){return t.lang().longDateFormat[e]||e}for(var i=5;i--&&S.test(e);)e=e.replace(S,n);return J[e]||(J[e]=m(e)),J[e](t)}function v(t){switch(t){case"DDDD":return q;case"YYYY":return F;case"S":case"SS":case"SSS":case"DDD":return R;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return L;case"Z":case"ZZ":return z;case"T":return H;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return Y;default:return RegExp(t.replace("\\",""))}}function _(t,e,n,i){var r,s;switch(t){case"M":case"MM":n[1]=null==e?0:~~e-1;break;case"MMM":case"MMMM":for(r=0;12>r;r++)if(f().monthsParse[r].test(e)){n[1]=r,s=!0;break}s||(n[8]=!1);break;case"D":case"DD":case"DDD":case"DDDD":null!=e&&(n[2]=~~e);break;case"YY":n[0]=~~e+(~~e>70?1900:2e3);break;case"YYYY":n[0]=~~Math.abs(e);break;case"a":case"A":i.isPm="pm"===(e+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":n[3]=~~e;break;case"m":case"mm":n[4]=~~e;break;case"s":case"ss":n[5]=~~e;break;case"S":case"SS":case"SSS":n[6]=~~(1e3*("0."+e));break;case"Z":case"ZZ":i.isUTC=!0,r=(e+"").match(Z),r&&r[1]&&(i.tzh=~~r[1]),r&&r[2]&&(i.tzm=~~r[2]),r&&"+"===r[0]&&(i.tzh=-i.tzh,i.tzm=-i.tzm)}null==e&&(n[8]=!1)}function g(t,e){var n,i,r=[0,0,1,0,0,0,0],s={tzh:0,tzm:0},o=e.match(O);for(n=0;o.length>n;n++)i=(v(o[n]).exec(t)||[])[0],i&&(t=t.slice(t.indexOf(i)+i.length)),te[o[n]]&&_(o[n],i,r,s);return s.isPm&&12>r[3]&&(r[3]+=12),s.isPm===!1&&12===r[3]&&(r[3]=0),l(r,s.isUTC,s.tzh,s.tzm)}function b(t,e){var n,i,s,o,a,u=t.match(U)||[],c=99;for(s=0;e.length>s;s++)o=g(t,e[s]),i=y(new r(o),e[s]).match(U)||[],a=h(u,i),c>a&&(c=a,n=o);return n}function w(t){var e,n="YYYY-MM-DDT";if($.exec(t)){for(e=0;4>e;e++)if(V[e][1].exec(t)){n+=V[e][0];break}return z.exec(t)?g(t,n+" Z"):g(t,n)}return new Date(t)}function x(t,e,n,i,r){var s=r.relativeTime[t];return"function"==typeof s?s(e||1,!!n,t,i):s.replace(/%d/i,e||1)}function P(t,e,n){var i=N(Math.abs(t)/1e3),r=N(i/60),s=N(r/60),o=N(s/24),a=N(o/365),u=45>i&&["s",i]||1===r&&["m"]||45>r&&["mm",r]||1===s&&["h"]||22>s&&["hh",s]||1===o&&["d"]||25>=o&&["dd",o]||45>=o&&["M"]||345>o&&["MM",N(o/30)]||1===a&&["y"]||["yy",a];return u[2]=e,u[3]=t>0,u[4]=n,x.apply({},u)}function A(t,e){moment.fn[t]=function(t){var n=this._isUTC?"UTC":"";return null!=t?(this._d["set"+n+e](t),this):this._d["get"+n+e]()}}function D(t){moment.duration.fn[t]=function(){return this._data[t]}}function B(t,e){moment.duration.fn["as"+t]=function(){return+this/e}}for(var moment,M,C="1.7.2",N=Math.round,k={},I="en",E="undefined"!=typeof module&&module.exports,T="months|monthsShort|weekdays|weekdaysShort|weekdaysMin|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),j=/^\/?Date\((\-?\d+)/i,O=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?|.)/g,S=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?)/g,U=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,Y=/\d\d?/,R=/\d{1,3}/,q=/\d{3}/,F=/\d{1,4}/,L=/[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/i,z=/Z|[\+\-]\d\d:?\d\d/i,H=/T/i,$=/^\s*\d{4}-\d\d-\d\d(T(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,X="YYYY-MM-DDTHH:mm:ssZ",V=[["HH:mm:ss.S",/T\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],Z=/([\+\-]|\d\d)/gi,G="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),W={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},J={},K="DDD w M D d".split(" "),Q="M D H h m s w".split(" "),te={M:function(){return this.month()+1},MMM:function(t){return e("monthsShort",this.month(),this,t)},MMMM:function(t){return e("months",this.month(),this,t)},D:function(){return this.date()},DDD:function(){var t=new Date(this.year(),this.month(),this.date()),e=new Date(this.year(),0,1);return~~((t-e)/864e5+1.5)},d:function(){return this.day()},dd:function(t){return e("weekdaysMin",this.day(),this,t)},ddd:function(t){return e("weekdaysShort",this.day(),this,t)},dddd:function(t){return e("weekdays",this.day(),this,t)},w:function(){var t=new Date(this.year(),this.month(),this.date()-this.day()+5),e=new Date(t.getFullYear(),0,4);return~~((t-e)/864e5/7+1.5)},YY:function(){return a(this.year()%100,2)},YYYY:function(){return a(this.year(),4)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return a(~~(this.milliseconds()/10),2)},SSS:function(){return a(this.milliseconds(),3)},Z:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+a(~~(t/60),2)+":"+a(~~t%60,2)},ZZ:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+a(~~(10*t/6),4)}};K.length;)M=K.pop(),te[M+"o"]=i(te[M]);for(;Q.length;)M=Q.pop(),te[M+M]=n(te[M],2);for(te.DDDD=n(te.DDD,3),moment=function(e,n){if(null===e||""===e)return null;var i,s;return moment.isMoment(e)?new r(new Date(+e._d),e._isUTC,e._lang):(n?i=c(n)?b(e,n):g(e,n):(s=j.exec(e),i=e===t?new Date:s?new Date(+s[1]):e instanceof Date?e:c(e)?l(e):"string"==typeof e?w(e):new Date(e)),new r(i))},moment.utc=function(t,e){return c(t)?new r(l(t,!0),!0):("string"!=typeof t||z.exec(t)||(t+=" +0000",e&&(e+=" Z")),moment(t,e).utc())},moment.unix=function(t){return moment(1e3*t)},moment.duration=function(t,e){var n,i=moment.isDuration(t),r="number"==typeof t,o=i?t._data:r?{}:t;return r&&(e?o[e]=t:o.milliseconds=t),n=new s(o),i&&(n._lang=t._lang),n},moment.humanizeDuration=function(t,e,n){return moment.duration(t,e===!0?null:e).humanize(e===!0?!0:n)},moment.version=C,moment.defaultFormat=X,moment.lang=function(t,e){var n;if(!t)return I;if((e||!k[t])&&d(t,e),k[t]){for(n=0;T.length>n;n++)moment[T[n]]=k[t][T[n]];moment.monthsParse=k[t].monthsParse,I=t}},moment.langData=f,moment.isMoment=function(t){return t instanceof r},moment.isDuration=function(t){return t instanceof s},moment.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(t){var e=t%10;return 1===~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"}}),moment.fn=r.prototype={clone:function(){return moment(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return""+this._d},toDate:function(){return this._d},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds(),!!this._isUTC]},isValid:function(){return this._a?null!=this._a[8]?!!this._a[8]:!h(this._a,(this._a[7]?moment.utc(this._a):moment(this._a)).toArray()):!isNaN(this._d.getTime())},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(t){return y(this,t?t:moment.defaultFormat)},add:function(t,e){var n=e?moment.duration(+e,t):moment.duration(t);return u(this,n,1),this},subtract:function(t,e){var n=e?moment.duration(+e,t):moment.duration(t);return u(this,n,-1),this},diff:function(t,e,n){var i,r=this._isUTC?moment(t).utc():moment(t).local(),s=6e4*(this.zone()-r.zone()),o=this._d-r._d-s,a=this.year()-r.year(),u=this.month()-r.month(),c=this.date()-r.date();return i="months"===e?12*a+u+c/30:"years"===e?a+(u+c/30)/12:"seconds"===e?o/1e3:"minutes"===e?o/6e4:"hours"===e?o/36e5:"days"===e?o/864e5:"weeks"===e?o/6048e5:o,n?i:N(i)},from:function(t,e){return moment.duration(this.diff(t)).lang(this._lang).humanize(!e)},fromNow:function(t){return this.from(moment(),t)},calendar:function(){var t=this.diff(moment().sod(),"days",!0),e=this.lang().calendar,n=e.sameElse,i=-6>t?n:-1>t?e.lastWeek:0>t?e.lastDay:1>t?e.sameDay:2>t?e.nextDay:7>t?e.nextWeek:n;return this.format("function"==typeof i?i.apply(this):i)},isLeapYear:function(){var t=this.year();return 0===t%4&&0!==t%100||0===t%400},isDST:function(){return this.zone()<moment([this.year()]).zone()||this.zone()<moment([this.year(),5]).zone()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==t?e:this.add({d:t-e})},startOf:function(t){switch(t.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return this},endOf:function(t){return this.startOf(t).add(t.replace(/s?$/,"s"),1).subtract("ms",1)},sod:function(){return this.clone().startOf("day")},eod:function(){return this.clone().endOf("day")},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return moment.utc([this.year(),this.month()+1,0]).date()},lang:function(e){return e===t?f(this):(this._lang=e,this)}},M=0;G.length>M;M++)A(G[M].toLowerCase(),G[M]);A("year","FullYear"),moment.duration.fn=s.prototype={weeks:function(){return o(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*this._months},humanize:function(t){var e=+this,n=this.lang().relativeTime,i=P(e,!t,this.lang()),r=0>=e?n.past:n.future;return t&&(i="function"==typeof r?r(i):r.replace(/%s/i,i)),i},lang:moment.fn.lang};for(M in W)W.hasOwnProperty(M)&&(B(M,W[M]),D(M.toLowerCase()));B("Weeks",6048e5),E&&(module.exports=moment),"undefined"==typeof ender&&(this.moment=moment),"function"==typeof define&&define.amd&&define("moment",[],function(){return moment})}).call(this),function(t,e){function n(t){return t&&t.__wrapped__?t:this instanceof n?(this.__wrapped__=t,e):new n(t)}function i(t,e,n){e||(e=0);var i=t.length,r=i-e>=(n||nn),s=r?{}:t;if(r)for(var o=e-1;i>++o;){var a=t[o]+"";(xn.call(s,a)?s[a]:s[a]=[]).push(t[o])}return function(t){if(r){var n=t+"";return xn.call(s,n)&&ue(s[n],t)>-1}return ue(s,t,e)>-1}}function r(t,n){var i=t.index,r=n.index;if(t=t.criteria,n=n.criteria,t!==n){if(t>n||t===e)return 1;if(n>t||n===e)return-1}return r>i?-1:1}function s(t,e,n){function i(){var a=arguments,u=s?this:e;if(r||(t=e[o]),n.length&&(a=a.length?n.concat(Dn.call(a)):n),this instanceof i){h.prototype=t.prototype,u=new h;var c=t.apply(u,a);return c&&ti[typeof c]?c:u}return t.apply(u,a)}var r=D(t),s=!n,o=t;return s&&(n=e),i}function o(t,n){return t?"function"!=typeof t?function(e){return e[t]}:n!==e?function(e,i,r){return t.call(n,e,i,r)}:t:Oe}function a(){for(var t,e={arrayLoop:"",bottom:"",hasDontEnumBug:We,isKeysFast:Jn,objectLoop:"",noArgsEnum:Hn,noCharByIndex:Vn,shadowed:yn,top:"",useHas:!0},n=0;t=arguments[n];n++)for(var i in t)e[i]=t[i];var r=e.args;e.firstArg=/^[^,]+/.exec(r)[0];var s=Function("createCallback, hasOwnProperty, isArguments, objectTypes, nativeKeys, propertyIsEnumerable, stringClass, toString","return function("+r+") {\n"+ni(e)+"\n}");return s(o,xn,d,ti,kn,An,Ln,Bn)}function u(t){return"\\"+ei[t]}function c(t){return ui[t]}function h(){}function l(t){return ci[t]}function d(t){return Bn.call(t)==jn}function f(t){var e=!1;if(!t||"object"!=typeof t||d(t))return e;var n=t.constructor;return Zn&&"function"!=typeof t.toString&&"string"==typeof(t+"")||D(n)&&!(n instanceof n)?e:Je?(oi(t,function(t,n,i){return e=!xn.call(i,n),!1}),e===!1):(oi(t,function(t,n){e=n}),e===!1||xn.call(t,e))}function p(t){var e=[];return ai(t,function(t,n){e.push(n)}),e}function m(t,e,n,i,r){if(null==t)return t;n&&(e=!1);var s=ti[typeof t];if(s){var o=Bn.call(t);if(!Qn[o]||$n&&d(t))return t;var a=o==On;s=a||(o==qn?fi(t):s)}if(!s||!e)return s?a?Dn.call(t):li({},t):t;var u=t.constructor;switch(o){case Sn:case Un:return new u(+t);case Rn:case Ln:return new u(t);case Fn:return u(t.source,hn.exec(t))}i||(i=[]),r||(r=[]);for(var c=i.length;c--;)if(i[c]==t)return r[c];var h=a?u(t.length):{};return i.push(t),r.push(h),(a?mi:ai)(t,function(t,n){h[n]=m(t,e,null,i,r)}),h}function y(t){var e=[];return oi(t,function(t,n){D(t)&&e.push(n)}),e.sort()}function v(t,e){return t?xn.call(t,e):!1}function _(t){var e={};return ai(t,function(t,n){e[t]=n}),e}function g(t){return t===!0||t===!1||Bn.call(t)==Sn}function b(t){return Bn.call(t)==Un}function w(t){return t?1===t.nodeType:!1}function x(t){var e=!0;if(!t)return e;var n=Bn.call(t),i=t.length;return n==On||n==Ln||n==jn||$n&&d(t)||n==qn&&"number"==typeof i&&D(t.splice)?!i:(ai(t,function(){return e=!1}),e)}function P(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;var r=Bn.call(t);if(r!=Bn.call(e))return!1;switch(r){case Sn:case Un:return+t==+e;case Rn:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case Fn:case Ln:return t==e+""}var s=r==On||r==jn;if($n&&!s&&(s=d(t))&&!d(e))return!1;if(!s){if(t.__wrapped__||e.__wrapped__)return P(t.__wrapped__||t,e.__wrapped__||e);if(r!=qn||Zn&&("function"!=typeof t.toString&&"string"==typeof(t+"")||"function"!=typeof e.toString&&"string"==typeof(e+"")))return!1;var o=t.constructor,a=e.constructor;if(o!=a&&!(D(o)&&o instanceof o&&D(a)&&a instanceof a))return!1}n||(n=[]),i||(i=[]);for(var u=n.length;u--;)if(n[u]==t)return i[u]==e;var c=-1,h=!0,l=0;if(n.push(t),i.push(e),s){if(l=t.length,h=l==e.length)for(;l--&&(h=P(t[l],e[l],n,i)););return h}for(var f in t)if(xn.call(t,f)&&(l++,!xn.call(e,f)||!P(t[f],e[f],n,i)))return!1;for(f in e)if(xn.call(e,f)&&!l--)return!1;if(We)for(;7>++c;)if(f=yn[c],xn.call(t,f)&&(!xn.call(e,f)||!P(t[f],e[f],n,i)))return!1;return!0}function A(t){return Nn(t?+t:parseFloat(t))}function D(t){return"function"==typeof t}function B(t){return t?ti[typeof t]:!1}function M(t){return Bn.call(t)==Rn&&t!=+t}function C(t){return null===t}function N(t){return Bn.call(t)==Rn}function k(t){return Bn.call(t)==Fn}function I(t){return Bn.call(t)==Ln}function E(t){return t===e}function T(t,e,n){var i=arguments,r=0,s=2,o=i[3],a=i[4];for(n!==en&&(o=[],a=[],s=i.length);s>++r;)ai(i[r],function(e,n){var i,r,s;if(e&&((r=di(e))||fi(e))){for(var u=o.length;u--&&!(i=o[u]==e););i?t[n]=a[u]:(o.push(e),a.push((s=t[n],s=r?di(s)?s:[]:fi(s)?s:{})),t[n]=T(s,e,en,o,a))}else null!=e&&(t[n]=e)});return t}function j(t,e,n){var i="function"==typeof e,r={};if(i)e=o(e,n);else var s=gn.apply(Ke,arguments);return oi(t,function(t,n,o){(i?!e(t,n,o):0>ue(s,n,1))&&(r[n]=t)}),r}function O(t){var e=[];return ai(t,function(t,n){e.push([n,t])}),e}function S(t,e,n){var i={};if("function"!=typeof e)for(var r=0,s=gn.apply(Ke,arguments),a=s.length;a>++r;){var u=s[r];u in t&&(i[u]=t[u])}else e=o(e,n),oi(t,function(t,n,r){e(t,n,r)&&(i[n]=t)});return i}function U(t){var e=[];return ai(t,function(t){e.push(t)}),e}function Y(t,e){var n=t?t.length:0;return"number"==typeof n?(Bn.call(t)==Ln?t.indexOf(e):ue(t,e))>-1:te(t,function(t){return t===e})}function R(t,e,n){var i={};return e=o(e,n),mi(t,function(t,n,r){n=e(t,n,r),xn.call(i,n)?i[n]++:i[n]=1}),i}function q(t,e,n){var i=!0;return e=o(e,n),mi(t,function(t,n,r){return i=e(t,n,r)}),!!i}function F(t,e,n){var i=[];return e=o(e,n),mi(t,function(t,n,r){e(t,n,r)&&i.push(t)}),i}function L(t,e,n){var i;return e=o(e,n),te(t,function(t,n,r){return e(t,n,r)&&(i=t,!0)}),i}function z(t,e,n){var i={};return e=o(e,n),mi(t,function(t,n,r){n=e(t,n,r),(xn.call(i,n)?i[n]:i[n]=[]).push(t)}),i}function H(t,e){var n=Dn.call(arguments,2),i="function"==typeof e,r=[];return mi(t,function(t){r.push((i?e:t[e]).apply(t,n))}),r}function $(t,e,n){var i=-1,r=t?t.length:0,s=Array("number"==typeof r?r:0);if(e=o(e,n),di(t))for(;r>++i;)s[i]=e(t[i],i,t);else mi(t,function(t,n,r){s[++i]=e(t,n,r)});return s}function X(t,e,n){var i=-1/0,r=-1,s=t?t.length:0,a=i;if(e||"number"!=typeof s)e=o(e,n),mi(t,function(t,n,r){var s=e(t,n,r);s>i&&(i=s,a=t)});else for(;s>++r;)t[r]>a&&(a=t[r]);return a}function V(t,e,n){var i=1/0,r=-1,s=t?t.length:0,a=i;if(e||"number"!=typeof s)e=o(e,n),mi(t,function(t,n,r){var s=e(t,n,r);i>s&&(i=s,a=t)});else for(;s>++r;)a>t[r]&&(a=t[r]);return a}function Z(t,e){var n=[];return mi(t,function(t){n.push(t[e])}),n}function G(t,e,n,i){var r=3>arguments.length;return e=o(e,i),mi(t,function(t,i,s){n=r?(r=!1,t):e(n,t,i,s)}),n}function W(t,e,n,i){var r=t,s=t?t.length:0,o=3>arguments.length;if("number"!=typeof s){var a=pi(t);s=a.length}else Vn&&Bn.call(t)==Ln&&(r=t.split(""));return mi(t,function(t,u,c){u=a?a[--s]:--s,n=o?(o=!1,r[u]):e.call(i,n,r[u],u,c)}),n}function J(t,e,n){return e=o(e,n),F(t,function(t,n,i){return!e(t,n,i)})}function K(t){var e=-1,n=Array(t?t.length:0);return mi(t,function(t){var i=bn(Tn()*(++e+1));n[e]=n[i],n[i]=t}),n}function Q(t){var e=t?t.length:0;return"number"==typeof e?e:pi(t).length}function te(t,e,n){var i;return e=o(e,n),mi(t,function(t,n,r){return!(i=e(t,n,r))}),!!i}function ee(t,e,n){var i=[];e=o(e,n),mi(t,function(t,n,r){i.push({criteria:e(t,n,r),index:n,value:t})});var s=i.length;for(i.sort(r);s--;)i[s]=i[s].value;return i}function ne(t){return t&&"number"==typeof t.length?(Xn?Bn.call(t)==Ln:"string"==typeof t)?t.split(""):Dn.call(t):U(t)}function ie(t,e){var n=[];return oi(e,function(t,e){n.push(e)}),F(t,function(t){for(var i=n.length;i--;){var r=t[n[i]]===e[n[i]];if(!r)break}return!!r})}function re(t){for(var e=-1,n=t?t.length:0,i=[];n>++e;){var r=t[e];r&&i.push(r)}return i}function se(t){for(var e=-1,n=t?t.length:0,r=gn.apply(Ke,arguments),s=i(r,n),o=[];n>++e;){var a=t[e];s(a)||o.push(a)}return o}function oe(t,n,i){return t?null==n||i?t[0]:Dn.call(t,0,n):e}function ae(t,e){for(var n=-1,i=t?t.length:0,r=[];i>++n;){var s=t[n];di(s)?Pn.apply(r,e?s:ae(s)):r.push(s)}return r}function ue(t,e,n){var i=-1,r=t?t.length:0;if("number"==typeof n)i=(0>n?In(0,r+n):n||0)-1;else if(n)return i=ye(t,e),t[i]===e?i:-1;for(;r>++i;)if(t[i]===e)return i;return-1}function ce(t,e,n){return t?Dn.call(t,0,-(null==e||n?1:e)):[]}function he(t){var e=arguments,n=e.length,r={},s=[];return mi(t,function(t){if(0>ue(s,t)){for(var o=n;--o;)if(!(r[o]||(r[o]=i(e[o])))(t))return;s.push(t)}}),s}function le(t,e,n){if(t){var i=t.length;return null==e||n?t[i-1]:Dn.call(t,-e||i)}}function de(t,e,n){var i=t?t.length:0;for("number"==typeof n&&(i=(0>n?In(0,i+n):En(n,i-1))+1);i--;)if(t[i]===e)return i;return-1}function fe(t,e){for(var n=-1,i=t?t.length:0,r={};i>++n;){var s=t[n];e?r[s]=e[n]:r[s[0]]=s[1]}return r}function pe(t,e,n){t=+t||0,n=+n||1,null==e&&(e=t,t=0);for(var i=-1,r=In(0,_n((e-t)/n)),s=Array(r);r>++i;)s[i]=t,t+=n;return s}function me(t,e,n){return t?Dn.call(t,null==e||n?1:e):[]}function ye(t,e,n,i){var r=0,s=t?t.length:r;for(n=n?o(n,i):Oe,e=n(e);s>r;){var a=r+s>>>1;e>n(t[a])?r=a+1:s=a}return r}function ve(){for(var t=-1,e=gn.apply(Ke,arguments),n=e.length,i=[];n>++t;){var r=e[t];0>ue(i,r)&&i.push(r)}return i}function _e(t,e,n,i){var r=-1,s=t?t.length:0,a=[],u=[];for("function"==typeof e&&(i=n,n=e,e=!1),n=o(n,i);s>++r;){var c=n(t[r],r,t);(e?!r||u[u.length-1]!==c:0>ue(u,c))&&(u.push(c),a.push(t[r]))}return a}function ge(t){for(var e=-1,n=t?t.length:0,r=i(arguments,1,20),s=[];n>++e;){var o=t[e];r(o)||s.push(o)}return s}function be(t){for(var e=-1,n=t?X(Z(arguments,"length")):0,i=Array(n);n>++e;)i[e]=Z(arguments,e);return i}function we(t,n){return 1>t?n():function(){return 1>--t?n.apply(this,arguments):e}}function xe(t,e){return Wn||Mn&&arguments.length>2?Mn.call.apply(Mn,arguments):s(t,e,Dn.call(arguments,2))}function Pe(t){for(var e=arguments,n=e.length>1?0:(e=y(t),-1),i=e.length;i>++n;){var r=e[n];t[r]=xe(t[r],t)}return t}function Ae(){var t=arguments;return function(){for(var e=arguments,n=t.length;n--;)e=[t[n].apply(this,e)];return e[0]}}function De(t,e,n){function i(){a=null,n||(s=t.apply(o,r))}var r,s,o,a;return function(){var u=n&&!a;return r=arguments,o=this,clearTimeout(a),a=setTimeout(i,e),u&&(s=t.apply(o,r)),s}}function Be(t,n){var i=Dn.call(arguments,2);return setTimeout(function(){t.apply(e,i)},n)}function Me(t){var n=Dn.call(arguments,1);return setTimeout(function(){t.apply(e,n)},1)}function Ce(t,e){return s(e,t,Dn.call(arguments,2))}function Ne(t,e){var n={};return function(){var i=e?e.apply(this,arguments):arguments[0];return xn.call(n,i)?n[i]:n[i]=t.apply(this,arguments)}}function ke(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}}function Ie(t){return s(t,Dn.call(arguments,1))}function Ee(t,e){function n(){a=new Date,o=null,r=t.apply(s,i)}var i,r,s,o,a=0;return function(){var u=new Date,c=e-(u-a);return i=arguments,s=this,0>=c?(clearTimeout(o),a=u,r=t.apply(s,i)):o||(o=setTimeout(n,c)),r}}function Te(t,e){return function(){var n=[t];return Pn.apply(n,arguments),e.apply(this,n)}}function je(t){return null==t?"":(t+"").replace(pn,c)}function Oe(t){return t}function Se(t){mi(y(t),function(e){var i=n[e]=t[e];n.prototype[e]=function(){var t=[this.__wrapped__];Pn.apply(t,arguments);var e=i.apply(n,t);return this.__chain__&&(e=new n(e),e.__chain__=!0),e}})}function Ue(){return t._=rn,this}function Ye(t,e){return null==t&&null==e&&(e=1),t=+t||0,null==e&&(e=t,t=0),t+bn(Tn()*((+e||0)-t+1))}function Re(t,e){var n=t?t[e]:null;return D(n)?t[e]():n}function qe(t,e,i){t||(t=""),i||(i={});var r,s,o=0,a=n.templateSettings,c="__p += '",h=i.variable||a.variable,l=h,d=RegExp((i.escape||a.escape||fn).source+"|"+(i.interpolate||a.interpolate||fn).source+"|"+(i.evaluate||a.evaluate||fn).source+"|$","g");if(t.replace(d,function(e,n,i,s,a){c+=t.slice(o,a).replace(mn,u),c+=n?"' +\n__e("+n+") +\n'":s?"';\n"+s+";\n__p += '":i?"' +\n((__t = ("+i+")) == null ? '' : __t) +\n'":"",r||(r=s||sn.test(n||i)),o=a+e.length}),c+="';\n",!l)if(h="obj",r)c="with ("+h+") {\n"+c+"\n}\n";else{var f=RegExp("(\\(\\s*)"+h+"\\."+h+"\\b","g");c=c.replace(ln,"$&"+h+".").replace(f,"$1__d")}c=(r?c.replace(an,""):c).replace(un,"$1").replace(cn,"$1;"),c="function("+h+") {\n"+(l?"":h+" || ("+h+" = {});\n")+"var __t, __p = '', __e = _.escape"+(r?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":(l?"":", __d = "+h+"."+h+" || "+h)+";\n")+c+"return __p\n}";var p=Kn?"\n//@ sourceURL="+(i.sourceURL||"/lodash/template/source["+vn++ +"]"):"";try{s=Function("_","return "+c+p)(n)}catch(m){throw m.source=c,m}return e?s(e):(s.source=c,s)}function Fe(t,e,n){t=+t||0;for(var i=-1,r=Array(t);t>++i;)r[i]=e.call(n,i);return r}function Le(t){return null==t?"":(t+"").replace(on,l)}function ze(t){var e=tn++;return t?t+e:e}function He(t){return t=new n(t),t.__chain__=!0,t}function $e(t,e){return e(t),t}function Xe(){return this.__chain__=!0,this}function Ve(){return this.__wrapped__}var Ze="object"==typeof exports&&exports,Ge="object"==typeof global&&global;Ge.global===Ge&&(t=Ge);var We,Je,Ke=[],Qe={},tn=0,en={},nn=30,rn=t._,sn=/[-?+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,on=/&(?:amp|lt|gt|quot|#x27);/g,an=/\b__p \+= '';/g,un=/\b(__p \+=) '' \+/g,cn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,hn=/\w*$/,ln=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,dn=RegExp("^"+(Qe.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),fn=/($^)/,pn=/[&<>"']/g,mn=/['\n\r\t\u2028\u2029\\]/g,yn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],vn=0,_n=Math.ceil,gn=Ke.concat,bn=Math.floor,wn=dn.test(wn=Object.getPrototypeOf)&&wn,xn=Qe.hasOwnProperty,Pn=Ke.push,An=Qe.propertyIsEnumerable,Dn=Ke.slice,Bn=Qe.toString,Mn=dn.test(Mn=Dn.bind)&&Mn,Cn=dn.test(Cn=Array.isArray)&&Cn,Nn=t.isFinite,kn=dn.test(kn=Object.keys)&&kn,In=Math.max,En=Math.min,Tn=Math.random,jn="[object Arguments]",On="[object Array]",Sn="[object Boolean]",Un="[object Date]",Yn="[object Function]",Rn="[object Number]",qn="[object Object]",Fn="[object RegExp]",Ln="[object String]",zn=(zn={0:1,length:1},Ke.splice.call(zn,0,1),zn[0]),Hn=!0;(function(){function t(){this.x=1}var e=[];t.prototype={valueOf:1,y:1};for(var n in new t)e.push(n);for(n in arguments)Hn=!n;We=!/valueOf/.test(e),Je="x"!=e[0]})(1);var $n=!d(arguments),Xn="x"!=Dn.call("x")[0],Vn="xx"!="x"[0]+Object("x")[0];try{var Zn=Bn.call(t.document||0)==qn}catch(Gn){}var Wn=Mn&&/\n|Opera/.test(Mn+Bn.call(t.opera)),Jn=kn&&/^.+$|true/.test(kn+!!t.attachEvent);try{var Kn=(Function("//@")(),!t.attachEvent)}catch(Gn){}var Qn={};Qn[jn]=Qn[Yn]=!1,Qn[On]=Qn[Sn]=Qn[Un]=Qn[Rn]=Qn[qn]=Qn[Fn]=Qn[Ln]=!0;var ti={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},ei={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};n.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:""};var ni=qe("<% if (obj.useStrict) { %>'use strict';\n<% } %>var index, value, iteratee = <%= firstArg %>, result = <%= firstArg %>;\nif (!<%= firstArg %>) return result;\n<%= top %>;\n<% if (arrayLoop) { %>var length = iteratee.length; index = -1;\nif (typeof length == 'number') {  <% if (noCharByIndex) { %>\n  if (toString.call(iteratee) == stringClass) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  while (++index < length) {\n    value = iteratee[index];\n    <%= arrayLoop %>\n  }\n}\nelse {  <%  } else if (noArgsEnum) { %>\n  var length = iteratee.length; index = -1;\n  if (length && isArguments(iteratee)) {\n    while (++index < length) {\n      value = iteratee[index += ''];\n      <%= objectLoop %>\n    }\n  } else {  <% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    value = iteratee[index];\n    <%= objectLoop %>\n    <% if (!hasDontEnumBug) { %>}\n<% } %>  }  <% } else { %>\n  for (index in iteratee) {<%    if (!hasDontEnumBug || useHas) { %>\n    if (<%      if (!hasDontEnumBug) { %>!(skipProto && index == 'prototype')<% }      if (!hasDontEnumBug && useHas) { %> && <% }      if (useHas) { %>hasOwnProperty.call(iteratee, index)<% }    %>) {    <% } %>\n    value = iteratee[index];\n    <%= objectLoop %>;    <% if (!hasDontEnumBug || useHas) { %>\n    }<% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    value = iteratee[index];\n    <%= objectLoop %>\n  }    <% } %>  <% } %>  <% if (arrayLoop || noArgsEnum) { %>\n}<% } %>\n<%= bottom %>;\nreturn result"),ii={args:"collection, callback, thisArg",top:"callback = createCallback(callback, thisArg)",arrayLoop:"if (callback(value, index, collection) === false) return result",objectLoop:"if (callback(value, index, collection) === false) return result"},ri={useHas:!1,args:"object",top:"for (var argsIndex = 1, argsLength = arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",objectLoop:"result[index] = value",bottom:"  }\n}"},si={arrayLoop:null};$n&&(d=function(t){return t?xn.call(t,"callee"):!1});var oi=a(ii,si,{useHas:!1}),ai=a(ii,si),ui={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},ci=_(ui),hi=a(ri,{objectLoop:"if (result[index] == null) "+ri.objectLoop}),li=a(ri),di=Cn||function(t){return Bn.call(t)==On};D(/x/)&&(D=function(t){return Bn.call(t)==Yn});var fi=wn?function(t){if(!t||"object"!=typeof t)return!1;var e=t.valueOf,n="function"==typeof e&&(n=wn(e))&&wn(n);return n?t==n||wn(t)==n&&!d(t):f(t)}:f,pi=kn?function(t){var e=typeof t;return"function"==e&&An.call(t,"prototype")?p(t):t&&ti[e]?kn(t):[]}:p,mi=a(ii);n.VERSION="0.9.0",n.after=we,n.bind=xe,n.bindAll=Pe,n.chain=He,n.clone=m,n.compact=re,n.compose=Ae,n.contains=Y,n.countBy=R,n.debounce=De,n.defaults=hi,n.defer=Me,n.delay=Be,n.difference=se,n.escape=je,n.every=q,n.extend=li,n.filter=F,n.find=L,n.first=oe,n.flatten=ae,n.forEach=mi,n.forIn=oi,n.forOwn=ai,n.functions=y,n.groupBy=z,n.has=v,n.identity=Oe,n.indexOf=ue,n.initial=ce,n.intersection=he,n.invert=_,n.invoke=H,n.isArguments=d,n.isArray=di,n.isBoolean=g,n.isDate=b,n.isElement=w,n.isEmpty=x,n.isEqual=P,n.isFinite=A,n.isFunction=D,n.isNaN=M,n.isNull=C,n.isNumber=N,n.isObject=B,n.isPlainObject=fi,n.isRegExp=k,n.isString=I,n.isUndefined=E,n.keys=pi,n.last=le,n.lastIndexOf=de,n.lateBind=Ce,n.map=$,n.max=X,n.memoize=Ne,n.merge=T,n.min=V,n.mixin=Se,n.noConflict=Ue,n.object=fe,n.omit=j,n.once=ke,n.pairs=O,n.partial=Ie,n.pick=S,n.pluck=Z,n.random=Ye,n.range=pe,n.reduce=G,n.reduceRight=W,n.reject=J,n.rest=me,n.result=Re,n.shuffle=K,n.size=Q,n.some=te,n.sortBy=ee,n.sortedIndex=ye,n.tap=$e,n.template=qe,n.throttle=Ee,n.times=Fe,n.toArray=ne,n.unescape=Le,n.union=ve,n.uniq=_e,n.uniqueId=ze,n.values=U,n.where=ie,n.without=ge,n.wrap=Te,n.zip=be,n.all=q,n.any=te,n.collect=$,n.detect=L,n.drop=me,n.each=mi,n.foldl=G,n.foldr=W,n.head=oe,n.include=Y,n.inject=G,n.methods=y,n.select=F,n.tail=me,n.take=oe,n.unique=_e,n._iteratorTemplate=ni,Se(n),n.prototype.chain=Xe,n.prototype.value=Ve,mi(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=Ke[t];
n.prototype[t]=function(){var t=this.__wrapped__;return e.apply(t,arguments),zn&&0===t.length&&delete t[0],this.__chain__&&(t=new n(t),t.__chain__=!0),t}}),mi(["concat","join","slice"],function(t){var e=Ke[t];n.prototype[t]=function(){var t=this.__wrapped__,i=e.apply(t,arguments);return this.__chain__&&(i=new n(i),i.__chain__=!0),i}}),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(t._=n,define(function(){return n})):Ze?"object"==typeof module&&module&&module.exports==Ze?(module.exports=n)._=n:Ze._=n:t._=n}(this),function(){var t=this.math={};t.mean=t.ave=t.average=function(e,n){return t.sum(e,n)/_(e).size()},t.median=function(e){var n=(e.length+1)/2,i=t.sort(e);return i.length%2?i[n-1]:(i[n-1.5]+i[n-.5])/2},t.pow=function(t,e){return _.isNumber(t)?Math.pow(t,e):_.isArray(t)?_.map(t,function(t){return _.pow(t,e)}):void 0},t.scale=function(t,e){var e=e||1,n=_.max(t);return _.map(t,function(t){return t*(e/n)})},t.slope=function(t,e){return(e[1]-t[1])/(e[0]-t[0])},t.sort=function(t){return t.sort(function(t,e){return t-e})},t.stdDeviation=t.sigma=function(t){return Math.sqrt(_(t).variance())},t.sum=function(t,e){if(_.isArray(t)&&"number"==typeof t[0])var n=t;else var e=e||"value",n=_(t).pluck(e);for(var i=0,r=0,s=n.length;s>r;r++)i+=n[r];return i},t.transpose=function(t){var e=[];return _(t).each(function(t,n){_(t).each(function(t,i){e[i]||(e[i]=[]),e[i][n]=t})}),e},t.variance=function(t){var e=_(t).mean();return _(t).chain().map(function(t){return _(t-e).pow(2)}).mean().value()},_.mixin(t)}(),function(t){function e(t){var e=v[t]={};return h(t.split(/\s+/),function(t){e[t]=!0}),e}var n={},i=Array.prototype,r=Object.prototype,s=r.hasOwnProperty,o=r.toString,a=i.forEach,u=i.indexOf,c=i.slice,h=function(t,e,i){var r,o,u;if(t)if(a&&t.forEach===a)t.forEach(e,i);else if(t.length===+t.length){for(o=0,u=t.length;u>o;o++)if(o in t&&e.call(i,t[o],o,t)===n)return}else for(r in t)if(s.call(t,r)&&e.call(i,t[r],r,t)===n)return},l=function(t){return!!(t&&t.constructor&&t.call&&t.apply)},d=function(t){return h(c.call(arguments,1),function(e){var n;for(n in e)void 0!==e[n]&&(t[n]=e[n])}),t},f=function(t,e,n){var i;if(e){if(u)return u.call(e,t,n);for(i=e.length,n=n?0>n?Math.max(0,i+n):n:0;i>n;n++)if(n in e&&e[n]===t)return n}return-1},p={};h("Boolean Number String Function Array Date RegExp Object".split(" "),function(t){p["[object "+t+"]"]=t.toLowerCase()});var m=function(t){return null==t?t+"":p[o.call(t)]||"object"},y={},v={};y.Callbacks=function(t){t="string"==typeof t?v[t]||e(t):d({},t);var n,i,r,s,o,a,u=[],c=!t.once&&[],l=function(e){for(n=t.memory&&e,i=!0,a=s||0,s=0,o=u.length,r=!0;u&&o>a;a++)if(u[a].apply(e[0],e[1])===!1&&t.stopOnFalse){n=!1;break}r=!1,u&&(c?c.length&&l(c.shift()):n?u=[]:p.disable())},p={add:function(){if(u){var e=u.length;(function i(e){h(e,function(e){var n=m(e);"function"!==n||t.unique&&p.has(e)?e&&e.length&&"string"!==n&&i(e):u.push(e)})})(arguments),r?o=u.length:n&&(s=e,l(n))}return this},remove:function(){return u&&h(arguments,function(t){for(var e;(e=f(t,u,e))>-1;)u.splice(e,1),r&&(o>=e&&o--,a>=e&&a--)}),this},has:function(t){return f(t,u)>-1},empty:function(){return u=[],this},disable:function(){return u=c=n=void 0,this},disabled:function(){return!u},lock:function(){return c=void 0,n||p.disable(),this},locked:function(){return!c},fireWith:function(t,e){return e=e||[],e=[t,e.slice?e.slice():e],!u||i&&!c||(r?c.push(e):l(e)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},y.Deferred=function(t){var e=[["resolve","done",y.Callbacks("once memory"),"resolved"],["reject","fail",y.Callbacks("once memory"),"rejected"],["notify","progress",y.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return y.Deferred(function(n){h(e,function(e,i){var s=e[0],o=t[i];r[e[1]](l(o)?function(){var t=o.apply(this,arguments);t&&l(t.promise)?t.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===r?n:this,[t])}:n[s])}),t=null}).promise()},promise:function(t){return"object"==typeof t?d(t,i):i}},r={};return i.pipe=i.then,h(e,function(t,s){var o=t[2],a=t[3];i[t[1]]=o.add,a&&o.add(function(){n=a},e[1^s][2].disable,e[2][2].lock),r[t[0]]=o.fire,r[t[0]+"With"]=o.fireWith}),i.promise(r),t&&t.call(r,r),r},y.when=function(t){var e,n,i,r=0,s=c.call(arguments),o=s.length,a=1!==o||t&&l(t.promise)?o:0,u=1===a?t:y.Deferred(),h=function(t,n,i){return function(r){n[t]=this,i[t]=arguments.length>1?c.call(arguments):r,i===e?u.notifyWith(n,i):--a||u.resolveWith(n,i)}};if(o>1)for(e=Array(o),n=Array(o),i=Array(o);o>r;r++)s[r]&&l(s[r].promise)?s[r].promise().done(h(r,i,s)).fail(u.reject).progress(h(r,n,e)):--a;return a||u.resolveWith(i,s),u.promise()},"undefined"!=typeof module&&module.exports?module.exports=y:t._!==void 0?t._.mixin(y):t._=y}(this),function(t,_){var e=t.Miso=t.Miso||{};e.Events={publish:function(t){var e=_.toArray(arguments);return e.shift(),this._events&&this._events[t]&&_.each(this._events[t],function(t){t.callback.apply(t.context||this,e)},this),this},subscribe:function(t,e,n){n=n||{},this._events=this._events||{},this._events[t]=this._events[t]||[];var i,r={callback:e,priority:n.priority||0,token:n.token||_.uniqueId("t"),context:n.context||this};return _.each(this._events[t],function(t,e){_.isUndefined(i)&&t.priority<=r.priority&&(i=e)}),this._events[t].splice(i,0,r),r.token},subscribeOnce:function(t,e,n){this._events=this._events||{},n=n||{};var i=this;return n.token===void 0&&(n.token=_.uniqueId("t")),this.subscribe(t,function(){i.unsubscribe(t,{token:n.token}),e.apply(this,arguments)},n)},unsubscribe:function(t,e){return _.isUndefined(this._events[t])?this:(this._events[t]=_.isFunction(e)?_.reject(this._events[t],function(t){return t.callback===e}):_.isString(e)?_.reject(this._events[t],function(t){return t.token===e}):[],this)}}}(this,_),function(t){t.Miso=t.Miso||{},t.Miso.Dataset=function(t){t=t||{},this.length=0,this._columns=[],this._columnPositionByName={},this._computedColumns=[],this._initialize(t)}}(this),function(t,_){var e=t.Miso||(t.Miso={}),n=t.Miso.Dataset;n.Column=function(t){return _.extend(this,t),this._id=t.id||_.uniqueId(),this.data=t.data||[],this},_.extend(n.Column.prototype,{toNumeric:function(t){return n.types[this.type].numeric(t)},numericAt:function(t){return this.toNumeric(this.data[t])},coerce:function(){this.data=_.map(this.data,function(t){return n.types[this.type].coerce(t,this)},this)},compute:function(t,e){if(this.func){var n=this.func(t);return e!==void 0?this.data[e]=n:this.data.push(n),n}},isComputed:function(){return!_.isUndefined(this.func)},_sum:function(){return _.sum(this.data)},_mean:function(){for(var t=0,e=0;this.data.length>e;e++)t+=this.numericAt(e);return t/=this.data.length,n.types[this.type].coerce(t,this)},_median:function(){return n.types[this.type].coerce(_.median(this.data),this)},_max:function(){for(var t=-1/0,e=0;this.data.length>e;e++)null!==this.data[e]&&n.types[this.type].compare(this.data[e],t)>0&&(t=this.numericAt(e));return n.types[this.type].coerce(t,this)},_min:function(){for(var t=1/0,e=0;this.data.length>e;e++)null!==this.data[e]&&0>n.types[this.type].compare(this.data[e],t)&&(t=this.numericAt(e));return n.types[this.type].coerce(t,this)}}),n.DataView=function(t){if(t!==void 0){if(t=t||(t={}),_.isUndefined(t.parent))throw Error("A view must have a parent specified.");this.parent=t.parent,this._initialize(t)}},_.extend(n.DataView.prototype,{_initialize:function(t){this.parent.syncable===!0&&(_.extend(this,e.Events),this.syncable=!0),this.idAttribute=this.parent.idAttribute,this.filter={},this.filter.columns=_.bind(this._columnFilter(t.filter.columns||void 0),this),this.filter.rows=_.bind(this._rowFilter(t.filter.rows||void 0),this),this._columns=this._selectData(),n.Builder.cacheColumns(this),n.Builder.cacheRows(this),this.syncable&&this.parent.subscribe("change",this._sync,{context:this})},_sync:function(t){var e=t.deltas,i=null;_.each(e,function(e,r){var s=this._rowPositionById[e[this.idAttribute]];if(s===void 0&&n.Event.isAdd(e))this.filter.rows&&this.filter.rows(e.changed)&&(this._add(e.changed),i="add");else{if("undefined"===s)return;_.each(e.changed,function(t,e){var n=this._columnPositionByName[e];_.isUndefined(n)||(this._columns[n].data[s]=t,i="update")},this)}var o=this.rowByPosition(s);if(n.Event.isRemove(e)||this.filter.row&&!this.filter.row(o)){var a={old:this.rowByPosition(s),changed:{}};a[this.idAttribute]=e[this.idAttribute],t.deltas.splice(r,1,a),this._remove(s),i="delete"}},this),this.syncable&&(this.publish(i,t),this.publish("change",t))},where:function(t,e){return e=e||{},e.filter=e.filter||{},_.isFunction(t)?e.filter.rows=t:e.filter=t,e.parent=this,new n.DataView(e)},_selectData:function(){var t=[];return _.each(this.parent._columns,function(e){this.filter.columns(e)&&t.push(new n.Column({name:e.name,data:[],type:e.type,_id:e._id}))},this),this.parent.each(function(e){if(this.filter.rows(e))for(var n=0;t.length>n;n++)t[n].data.push(e[t[n].name])},this),t},_columnFilter:function(t){var e;return _.isUndefined(t)?e=function(){return!0}:(_.isString(t)&&(t=[t]),t.push(this.idAttribute),e=function(e){return-1===_.indexOf(t,e.name)?!1:!0}),e},_rowFilter:function(t){var e;return _.isNumber(t)&&(t=[t]),e=_.isUndefined(t)?function(){return!0}:_.isFunction(t)?t:_.bind(function(e){return-1===_.indexOf(t,e[this.idAttribute])?!1:!0},this)},column:function(t){return this._column(t)},_column:function(t){if(_.isUndefined(this._columnPositionByName))return void 0;var e=this._columnPositionByName[t];return this._columns[e]},columns:function(t){return new n.DataView({filter:{columns:t},parent:this})},columnNames:function(){var t=_.pluck(this._columns,"name");return _.reject(t,function(t){return t===this.idAttribute||"_oids"===t},this)},hasColumn:function(t){return!_.isUndefined(this._columnPositionByName[t])},each:function(t,e){for(var n=0;this.length>n;n++)t.apply(e||this,[this.rowByPosition(n),n])},reverseEach:function(t,e){for(var n=this.length-1;n>=0;n--)t.apply(e||this,[this.rowByPosition(n),n])},eachColumn:function(t,e){for(var n=this.columnNames(),i=0;n.length>i;i++)t.apply(e||this,[n[i],this.column(n[i]),i])},rowByPosition:function(t){return this._row(t)},rowById:function(t){return this._row(this._rowPositionById[t])},_row:function(t){var e={};return _.each(this._columns,function(n){e[n.name]=n.data[t]}),e},_remove:function(t){var e=this._rowPositionById[t];return _.each(this._columns,function(t){t.data.splice(e,1)}),delete this._rowPositionById[t],this._rowIdByPosition.splice(e,1),this.length--,this},_add:function(t){if(_.each(t,function(e,i){var r=this.column(i);if(r.isComputed())throw"You're trying to update a computed column. Those get computed!";if(r!==void 0){var s=n.types[r.type];if(!r.force&&!s.test(t[r.name],r))throw"incorrect value '"+t[r.name]+"' of type "+n.typeOf(t[r.name],r)+" passed to column '"+r.name+"' with type "+r.type;_.isUndefined(r.before)||(t[r.name]=r.before(t[r.name])),t[r.name]=s.coerce(t[r.name],r)}},this),this._computedColumns&&_.each(this._computedColumns,function(e){var n=e.compute(t);t[e.name]=n}),_.isUndefined(this.comparator)){if(_.each(this._columns,function(e){e.isComputed()||e.data.push(_.isUndefined(t[e.name])||_.isNull(t[e.name])?null:t[e.name])}),this.length++,this._rowIdByPosition=this._rowIdByPosition||(this._rowIdByPosition=[]),this._rowPositionById=this._rowPositionById||(this._rowPositionById={}),this._rowPositionById[t[this.idAttribute]]!==void 0)throw"The id "+t[this.idAttribute]+" is not unique. The "+this.idAttribute+" column must be unique";this._rowPositionById[t[this.idAttribute]]=this._rowIdByPosition.length,this._rowIdByPosition.push(t[this.idAttribute])}else{var e,i=function(t,e,n){Array.prototype.splice.apply(n,[t,0].concat(e))};for(this.length++,e=0;this.length>e;e++){var r=this.rowByPosition(e);if(_.isUndefined(r[this.idAttribute])||0>this.comparator(t,r)){_.each(this._columns,function(n){i(e,t[n.name]?t[n.name]:null,n.data)});break}}this._rowIdByPosition=[],this._rowPositionById={},this.each(function(t,e){this._rowIdByPosition.push(t[this.idAttribute]),this._rowPositionById[t[this.idAttribute]]=e},this)}return this},rows:function(t){return new n.DataView({filter:{rows:t},parent:this})},sort:function(t){var e={},n=[];if(_.isFunction(t)?e.comparator=t:e=t||{},e.comparator)this.comparator=e.comparator;else if(_.isUndefined(this.comparator))throw Error("Cannot sort without this.comparator.");var i,r,s;for(i=0;this.length>i;i++)n[i]=this._row(i);for(n.sort(this.comparator),i=n.length;i--;)for(s=n[i],this._rowIdByPosition[i]=s[this.idAttribute],this._rowPositionById[s[this.idAttribute]]=i,r=this._columns.length;r--;){var o=this._columns[r];o.data[i]=s[o.name]}return this.syncable&&!e.silent&&this.publish("sort"),this},toJSON:function(){for(var t=[],e=0;this.length>e;e++)t.push(this.rowByPosition(e));return t}})}(this,_),function(t,_){var e=t.Miso||(t.Miso={}),n=t.Miso.Dataset;n.prototype=new n.DataView,_.extend(n.prototype,{_initialize:function(t){t.sync===!0&&(_.extend(this,e.Events),this.syncable=!0),this.idAttribute=t.idAttribute||"_id",this.importer=t.importer||null,this.parser=t.parser||n.Parsers.Obj,_.isUndefined(t.parser)&&(t.strict?this.parser=n.Parsers.Strict:t.delimiter&&(this.parser=n.Parsers.Delimited)),null===this.importer&&(t.url?t.interval?(this.importer=n.Importers.Polling,this.interval=t.interval):this.importer=n.Importers.Remote:this.importer=n.Importers.Local),this.parser=new this.parser(t),this.parser instanceof n.Parsers.Delimited&&(t.dataType="text"),this.importer=new this.importer(t),t.comparator&&(this.comparator=t.comparator),t.ready&&(this.ready=t.ready),t.resetOnFetch&&(this.resetOnFetch=t.resetOnFetch),t.uniqueAgainst&&(this.uniqueAgainst=t.uniqueAgainst),_.isUndefined(t.data)&&_.isUndefined(t.url)&&this._addIdColumn(),this.deferred=t.deferred?t.deferred:new _.Deferred,t.columns&&this.addColumns(t.columns)},fetch:function(t){t=t||{};var e=this.deferred;if(_.isNull(this.importer))throw"No importer defined";return this.importer.fetch({success:_.bind(function(n){try{this._apply(n)}catch(i){if(!t.error)throw i;t.error.call(this,i)}this.comparator&&this.sort(),this.ready&&this.ready.call(this),t.success&&t.success.call(this),e.resolveWith(this,[this])},this),error:_.bind(function(n){t.error&&t.error.call(this,n),e.reject(n)},this)}),e.promise()},_applications:{againstColumn:function(t){var e=(_.keys(t),this.uniqueAgainst),i=this.column(e),r=[],s=[];_.each(t[e],function(e,o){var a=i.data.indexOf(n.types[i.type].coerce(e)),u={};_.each(t,function(t,e){u[e]=t[o]}),-1===a?r.push(u):(s.push(u),u[this.idAttribute]=this.rowById(this.column(this.idAttribute).data[a])[this.idAttribute],this.update(u))},this),r.length>0&&this.add(r)},blind:function(t){for(var e,n=[],i=_.keys(t),r=_.max(_.map(i,function(e){return t[e].length},this)),s=0;r>s;s++){e={};for(var o=0;i.length>o;o++)e[i[o]]=t[i[o]][s];n.push(e)}this.add(n)}},_apply:function(t){var e=this.parser.parse(t);if(this.fetched)if(this.resetOnFetch)this.reset(),this._applications.blind.call(this,e.data);else if(this.uniqueAgainst){if(!this.hasColumn(this.uniqueAgainst))throw Error("You requested a unique add against a column that doesn't exist.");this._applications.againstColumn.call(this,e.data)}else this._applications.blind.call(this,e.data);else this._addIdColumn(),this.addColumns(_.map(e.columns,function(t){return{name:t}})),n.Builder.detectColumnTypes(this,e.data),this._applications.blind.call(this,e.data),this.fetched=!0;n.Builder.cacheRows(this)},addColumns:function(t){_.each(t,function(t){this.addColumn(t)},this)},addComputedColumn:function(t,e,i){if(_.isUndefined(this.column(t))){if(n.types[e]===void 0)throw"The type "+e+" doesn't exist";var r=new n.Column({name:t,type:e,func:_.bind(i,this)});return this._columns.push(r),this._computedColumns.push(r),this._columnPositionByName[r.name]=this._columns.length-1,this.length>0&&this.each(function(t,e){r.compute(t,e)},this),r}throw"There is already a column by this name."},addColumn:function(t){return _.isUndefined(this.column(t.name))?(t=new n.Column(t),this._columns.push(t),this._columnPositionByName[t.name]=this._columns.length-1,t):!1},_addIdColumn:function(t){if(_.isUndefined(this.column(this.idAttribute))){var e=[];t&&t>0&&_.times(t,function(){e.push(_.uniqueId())});var n=this.addColumn({name:this.idAttribute,data:e});if("_id"===this.idAttribute&&(n.type="number"),0!==this._columnPositionByName[this.idAttribute]){var i=this._columnPositionByName[this.idAttribute];this._columns.splice(i,1),this._columns.unshift(n),this._columnPositionByName[this.idAttribute]=0,_.each(this._columnPositionByName,function(t,e){e!==this.idAttribute&&i>this._columnPositionByName[e]&&this._columnPositionByName[e]++},this)}}},add:function(t,e){e=e||{},_.isArray(t)||(t=[t]);var i=[];if(_.each(t,function(t){t[this.idAttribute]||(t[this.idAttribute]=_.uniqueId()),this._add(t,e),this.syncable&&!e.silent&&i.push({changed:t})},this),this.syncable&&!e.silent){var r=n.Events._buildEvent(i,this);this.publish("add",r),this.publish("change",r)}return this},remove:function(t,e){t=this._rowFilter(t);var i=[],r=[];if(this.each(function(e){t(e)&&(r.push(e[this.idAttribute]),i.push({old:e}))}),_.each(r,function(t){this._remove(t)},this),this.syncable&&(!e||!e.silent)){var s=n.Events._buildEvent(i,this);this.publish("remove",s),this.publish("change",s)}},_arrayUpdate:function(t){var e=[];return _.each(t,function(t){var i={old:{},changed:{}};i[this.idAttribute]=t[this.idAttribute];var r=this._rowPositionById[t[this.idAttribute]];_.each(t,function(t,e){var s=this._columns[this._columnPositionByName[e]],o=n.types[s.type];if(s.name===this.idAttribute&&s.data[r]!==t)throw"You can't update the id column";if(s===void 0)throw"column "+e+" not found!";if(!o.test(t,s))throw"Value is incorrect type";this._computedColumns[s.name]||(t=o.coerce(t,s),_.isUndefined(s.before)||(t=s.before(t)),s.data[r]!==t&&(i.old[e]=s.data[r],s.data[r]=t,i.changed[e]=t))},this),this._computedColumns!==void 0&&_.each(this._computedColumns,function(t){var e=_.extend({},this._row(r)),n=e[t.name],s=t.compute(e,r);n!==s&&(i.old[t.name]=n,t.data[r]=s,i.changed[t.name]=s)},this),_.keys(i.changed).length>0&&e.push(i)},this),e},_functionUpdate:function(t){for(var e=[],n=0;this.length>n;n++){var i=t(this.rowByPosition(n));i!==!1&&e.push(i)}return this._arrayUpdate(e)},update:function(t,e){var i;if(_.isFunction(t))i=this._functionUpdate(t);else{var r=_.isArray(t)?t:[t];i=this._arrayUpdate(r)}if(this.syncable&&(!e||!e.silent)){var s=n.Events._buildEvent(i,this);this.publish("update",s),this.publish("change",s)}return this},reset:function(t){_.each(this._columns,function(t){t.data=[]}),this.length=0,!this.syncable||t&&t.silent||this.publish("reset")}})}(this,_,moment),function(t,_){var e=t.Miso.Dataset;e.typeOf=function(t,n){var i,r=_.keys(e.types);return r.push(r.splice(_.indexOf(r,"string"),1)[0]),r.push(r.splice(_.indexOf(r,"mixed"),1)[0]),i=_.find(r,function(i){return e.types[i].test(t,n)}),i=_.isUndefined(i)?"string":i},e.types={mixed:{name:"mixed",coerce:function(t){return _.isNull(t)||t===void 0||_.isNaN(t)?null:t},test:function(){return!0},compare:function(t,e){return _.isEqual(t,e)?0:e>t?-1:t>e?1:void 0},numeric:function(t){return null===t||_.isNaN(+t)?null:+t}},string:{name:"string",coerce:function(t){return _.isNaN(t)||null===t||t===void 0?null:""+t},test:function(t){return null===t||t===void 0||"string"==typeof t},compare:function(t,e){return null==t&&null!=e?-1:null!=t&&null==e?1:e>t?-1:t>e?1:0},numeric:function(t){return _.isNaN(+t)||null===t?null:_.isNumber(+t)?+t:null}},"boolean":{name:"boolean",regexp:/^(true|false)$/,coerce:function(t){return _.isNaN(t)||null===t||t===void 0?null:"false"===t?!1:Boolean(t)},test:function(t){return null===t||t===void 0||"boolean"==typeof t||this.regexp.test(t)?!0:!1},compare:function(t,e){return null==t&&null!=e?-1:null!=t&&null==e?1:null==t&&null==e?0:t===e?0:e>t?-1:1},numeric:function(t){return null===t||_.isNaN(t)?null:t?1:0}},number:{name:"number",regexp:/^\s*[\-\.]?[0-9]+([\.][0-9]+)?\s*$/,coerce:function(t){var e=+t;return _.isNull(t)||t===void 0||_.isNaN(e)?null:e},test:function(t){return null===t||t===void 0||"number"==typeof t||this.regexp.test(t)?!0:!1},compare:function(t,e){return null==t&&null!=e?-1:null!=t&&null==e?1:null==t&&null==e?0:t===e?0:e>t?-1:1},numeric:function(t){return _.isNaN(t)||null===t?null:t}},time:{name:"time",format:"DD/MM/YYYY",_formatLookup:[["DD","\\d{2}"],["D","\\d{1}|\\d{2}"],["MM","\\d{2}"],["M","\\d{1}|\\d{2}"],["YYYY","\\d{4}"],["YY","\\d{2}"],["A","[AM|PM]"],["hh","\\d{2}"],["h","\\d{1}|\\d{2}"],["mm","\\d{2}"],["m","\\d{1}|\\d{2}"],["ss","\\d{2}"],["s","\\d{1}|\\d{2}"],["ZZ","[-|+]\\d{4}"],["Z","[-|+]\\d{2}:\\d{2}"]],_regexpTable:{},_regexp:function(t){if(this._regexpTable[t])return RegExp(this._regexpTable[t],"g");var e=t;return _.each(this._formatLookup,function(t){e=e.replace(t[0],t[1])},this),e=e.split("/").join("\\/"),this._regexpTable[t]=e,RegExp(this._regexpTable[t],"g")},coerce:function(t,e){if(e=e||{},_.isNull(t)||t===void 0||_.isNaN(t))return null;if(_.isString(t)){var n=e.format||this.format;return moment(t,n)}return _.isNumber(t)?moment(t):t},test:function(t,e){if(e=e||{},null===t||t===void 0)return!0;if(_.isString(t)){var n=e.format||this.format,i=this._regexp(n);return i.test(t)}return!0},compare:function(t,e){return e>t?-1:t>e?1:0},numeric:function(t){return _.isNaN(t)||null===t?null:t.valueOf()}}}}(this,_),function(t,_){var e=t.Miso.Dataset;e.Event=function(t,e){_.isArray(t)||(t=[t]),this.deltas=t,this.dataset=e||null},_.extend(e.Event.prototype,{affectedColumns:function(){var t=[];return _.each(this.deltas,function(e){e.old=e.old||[],e.changed=e.changed||[],t=_.chain(t).union(_.keys(e.old),_.keys(e.changed)).reject(function(t){return t===this.dataset.idAttribute},this).value()},this),t}}),_.extend(e.Event,{isRemove:function(t){return _.isUndefined(t.changed)||0===_.keys(t.changed).length?!0:!1},isAdd:function(t){return _.isUndefined(t.old)||0===_.keys(t.old).length?!0:!1},isUpdate:function(t){return this.isRemove(t)||this.isAdd(t)?!1:!0}}),e.Events={},e.Events._buildEvent=function(t,n){return new e.Event(t,n)}}(this,_),function(t,_){var e=t.Miso.Dataset;e.Builder={detectColumnType:function(t,n){var i=_.inject(n.slice(0,5),function(t,n){var i=e.typeOf(n);return""===n||-1!==t.indexOf(i)||_.isNull(n)||t.push(i),t},[]);return t.type=1===i.length?i[0]:"mixed",t},detectColumnTypes:function(t,n){_.each(n,function(n,i){var r=t.column(i);return r.type?(r.force=!0,void 0):(e.Builder.detectColumnType(r,n),void 0)},this)},cacheRows:function(t){e.Builder.clearRowCache(t),_.each(t._columns[t._columnPositionByName[t.idAttribute]].data,function(e,n){t._rowPositionById[e]=n,t._rowIdByPosition.push(e)},t);var n=_.uniq(_.map(t._columns,function(t){return t.data.length}));if(n.length>1)throw Error("Row lengths need to be the same. Empty values should be set to null."+_.map(t._columns,function(t){return t.data+"|||"}));t.length=n[0]},clearRowCache:function(t){t._rowPositionById={},t._rowIdByPosition=[]},cacheColumns:function(t){t._columnPositionByName={},_.each(t._columns,function(e,n){t._columnPositionByName[e.name]=n})}},Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){for(var n=e||0,i=this.length;i>n;n++)if(this[n]===t)return n;return-1})}(this,_),function(t,_){var e=t.Miso||(t.Miso={}),n=t.Miso.Dataset;n.Product=function(t){if(t=t||{},this.func=t.func,t.columns){var e=t.columns;_.isArray(t.columns)&&(e=t.columns[0]),this.valuetype=e.type,this.numeric=function(){return e.toNumeric(this.value)}}return this.func({silent:!0}),this},_.extend(n.Product.prototype,e.Events,{val:function(){return this.value},type:function(){return this.valuetype},_sync:function(){this.func()},_buildDelta:function(t,e){return{old:t,changed:e}}}),n.Product.define=function(t){return function(e,i){i=i||{};var r=this._findColumns(e),s=this;i.type=i.type||r[0].type,i.typeOptions=i.typeOptions||r[0].typeOptions;var o=function(){var e=t.call(s,r,i);return n.types[i.type].coerce(e,i.typeOptions)};if(this.syncable){var a=new n.Product({columns:r,func:function(t){t=t||{};var e=this._buildDelta(this.value,o.call(s));if(this.value=e.changed,s.syncable){var i=n.Events._buildEvent(e,this);_.isUndefined(e.old)||t.silent||e.old===e.changed||this.publish("change",i)}}});return this.subscribe("change",a._sync,{context:a}),a}return o.call(s)}},_.extend(n.DataView.prototype,{_findColumns:function(t){var e=[];return _.isUndefined(t)&&(t=this.columnNames()),t=_.isArray(t)?t:[t],_.each(t,function(t){t=this._columns[this._columnPositionByName[t]],e.push(t)},this),e},sum:n.Product.define(function(t){return _.each(t,function(t){if(t.type===n.types.time.name)throw Error("Can't sum up time")}),_.sum(_.map(t,function(t){return t._sum()}))}),max:n.Product.define(function(t){return _.max(_.map(t,function(t){return t._max()}))}),min:n.Product.define(function(t){return _.min(_.map(t,function(t){return t._min()}))}),mean:n.Product.define(function(t){var e=[];_.each(t,function(t){e.push(t.data)}),e=_.flatten(e);var i=t[0].type;return e=_.map(e,function(t){return n.types[i].numeric(t)}),_.mean(e)})})}(this,_),function(t,_){var e=t.Miso.Dataset;e.Importers=function(){},e.Importers.prototype.extract=function(t){return t=_.clone(t)}}(this,_),function(t,_){var e=t.Miso.Dataset;e.Importers.Local=function(t){t=t||{},this.data=t.data||null,this.extract=t.extract||this.extract},_.extend(e.Importers.Local.prototype,e.Importers.prototype,{fetch:function(t){var e=t.data?t.data:this.data;t.success(this.extract(e))}})}(this,_),function(t,_){var e=t.Miso.Dataset;e.Importers.Remote=function(t){t=t||{},this._url=t.url,this.extract=t.extract||this.extract,this.params={type:"GET",url:_.isFunction(this._url)?_.bind(this._url,this):this._url,dataType:t.dataType?t.dataType:t.jsonp?"jsonp":"json",callback:t.callback,headers:t.headers}},_.extend(e.Importers.Remote.prototype,e.Importers.prototype,{fetch:function(t){var n=_.bind(function(e){t.success(this.extract(e))},this);this.callback&&(window[this.callback]=n),e.Xhr(_.extend(this.params,{success:this.callback?this.callback:n,error:t.error}))}});var n={url:"",data:"",dataType:"",success:function(){},type:"GET",async:!0,headers:{},xhr:function(){return t.ActiveXObject?new t.ActiveXObject("Microsoft.XMLHTTP"):new t.XMLHttpRequest}},i=/\?/;e.Xhr=function(t){t.dataType=t.dataType&&t.dataType.toLowerCase()||null;var r=_.isFunction(t.url)?t.url():t.url;if(t.dataType&&("jsonp"===t.dataType||"script"===t.dataType))return e.Xhr.getJSONP(r,t.success,"script"===t.dataType,t.error,t.callback),void 0;var s=_.extend({},n,t,{url:r});return s.ajax=s.xhr(),s.ajax?("GET"===s.type&&s.data&&(s.url+=(i.test(s.url)?"&":"?")+s.data,s.data=null),s.ajax.open(s.type,s.url,s.async),t.headers&&_(t.headers).forEach(function(t,e){s.ajax.setRequestHeader(e,t)}),s.ajax.send(s.data||null),e.Xhr.httpData(s)):void 0},e.Xhr.getJSONP=function(t,e,n,i,r){if(n){var s=document.querySelectorAll('script[src="'+t+'"]');if(s.length)return e&&e(!0),void 0}var o,a=document.head||document.getElementsByTagName("head")[0]||document.documentElement,u=document.createElement("script"),c=t.split("?")[1],h=!1,l=[];if(c&&!n&&(l=c.split("&")),l.length&&(o=l[l.length-1].split("=")),!r){var d=_.uniqueId("callback");r=l.length?o[1]?o[1]:d:d}c||n||(t+="?"),c&&/callback/.test(c)||(c&&(t+="&"),t+="callback="+r),r&&!n&&(window[r]&&(r=r+ +new Date+_.uniqueId()),window[r]=function(t){e&&e(t),h=!0},o&&(t=t.replace(o.join("="),o[0]+"="+r))),u.onload=u.onreadystatechange=function(){if((!u.readyState||/loaded|complete/.test(u.readyState))&&(n&&e&&e(),h)){try{delete window[r]}catch(t){window[r]=void 0}a.removeChild(u)}},u.onerror=function(t){i&&i.call(null,t)},u.src=t,a.insertBefore(u,a.firstChild)},e.Xhr.httpData=function(t){var e,n,i=null;return n=function(){if(4===t.ajax.readyState){try{i=JSON.parse(t.ajax.responseText)}catch(n){}e={xml:t.ajax.responseXML,text:t.ajax.responseText,json:i},t.dataType&&(e=e[t.dataType]),/(2..)/.test(t.ajax.status)?t.success.call(t.ajax,e):t.error&&t.error.call(null,t.ajax.statusText)}},4===t.ajax.readyState?n():t.ajax.onreadystatechange=n,e}}(this,_),function(t,_){var e=t.Miso.Dataset;e.Importers.Polling=function(t){t=t||{},this.interval=t.interval||1e3,this._def=null,e.Importers.Remote.apply(this,[t])},_.extend(e.Importers.Polling.prototype,e.Importers.Remote.prototype,{fetch:function(n){null===this._def&&(this._def=_.Deferred(),this.success_callback=_.bind(function(t){n.success(this.extract(t)),this._def.resolve(this)},this),this.error_callback=_.bind(function(t){n.error(t),this._def.reject(t)},this)),_.when(this._def.promise()).then(function(t){var e=_.bind(function(){this.fetch({success:this.success_callback,error:this.error_callback})},t);t._timeout=setTimeout(e,t.interval),t._def=_.Deferred()}),e.Xhr(_.extend(this.params,{success:this.success_callback,error:this.error_callback})),t.imp=this},stop:function(){null!==this._def&&this._def.reject(),this._timeout!==void 0&&clearTimeout(this._timeout)},start:function(){null!==this._def&&(this._def=_.Deferred(),this.fetch())}})}(this,_),function(t,_){var e=t.Miso.Dataset;e.Importers.GoogleSpreadsheet=function(t){if(t=t||{},t.url)t.url=t.url;else{if(_.isUndefined(t.key))throw Error("Set options 'key' properties to point to your google document.");t.fast?(t.url="https://spreadsheets.google.com/tq?key="+t.key,t.sheetName===void 0&&(t.sheetName="Sheet1"),t.url+="&sheet="+t.sheetName,this.callback="misodsgs"+(new Date).getTime(),t.url+="&tqx=version:0.6;responseHandler:"+this.callback,t.url+=";reqId:0;out:json&tq&_=1335871249558#",delete t.sheetName):t.url="https://spreadsheets.google.com/feeds/cells/"+t.key+"/"+t.worksheet+"/public/basic?alt=json-in-script&callback=",delete t.key}return this.params={type:"GET",url:t.url,dataType:"jsonp"},this},_.extend(e.Importers.GoogleSpreadsheet.prototype,e.Importers.Remote.prototype)}(this,_),function(t,_){var e=t.Miso.Dataset;e.Parsers=function(t){this.options=t||{}},_.extend(e.Parsers.prototype,{parse:function(){}})}(this,_),function(t,_){var e=t.Miso.Dataset;e.Parsers.Strict=function(t){this.options=t||{}},_.extend(e.Parsers.Strict.prototype,e.Parsers.prototype,{parse:function(t){var e={},n=[];return _.each(t.columns,function(t){if(-1!==n.indexOf(t.name))throw Error('You have more than one column named "'+t.name+'"');n.push(t.name),e[t.name]=t.data}),{columns:n,data:e}}})}(this,_),function(t,_){var e=t.Miso.Dataset;e.Parsers.Obj=e.Parsers,_.extend(e.Parsers.Obj.prototype,e.Parsers.prototype,{parse:function(t){var e=_.keys(t[0]),n={};return _.each(e,function(t){n[t]=[]}),_.each(e,function(e){_.times(t.length,function(i){n[e].push(t[i][e])})}),{columns:e,data:n}}})}(this,_),function(t,_){var e=t.Miso.Dataset;e.Parsers.GoogleSpreadsheet=function(t){this.fast=t.fast||!1},_.extend(e.Parsers.GoogleSpreadsheet.prototype,e.Parsers.prototype,{parse:function(t){var e,n=[],i=[],r={};if(t.status!==void 0&&"error"===t.status)throw Error("You can't use the fast importer for this url. Disable the fast flag");if(this.fast){if(n=_.pluck(t.table.cols,"label"),_.unique(n).length<n.length){var s="";throw _.inject(n,function(t,e){return t[e]=t[e]+1||1,t[e]>1&&(s=e),t},{}),Error('You have more than one column named "'+s+'"')}_.each(t.table.rows,function(t){for(t=t.c,e=0;t.length>e;e++)i[e]=i[e]||[],""===t[e].v?i[e].push(null):i[e].push(t[e].v)}),_.each(n,function(t,e){r[t]=i[e]})}else{var o=/([A-Z]+)(\d+)/,a={};_.each(t.feed.entry,function(t){var e=o.exec(t.title.$t),r=e[1],s=parseInt(e[2],10);if(1===s){if(-1!==n.indexOf(t.content.$t))throw Error('You have more than one column named "'+t.content.$t+'"');a[r]=i.length,n[a[r]]=t.content.$t,i[a[r]]=[]}else{var u=a[r];i[u][s-1]=t.content.$t}},this),_.each(i,function(t,e){t.length=_.max(_.pluck(i,"length")),t.splice(0,1);for(var s=0;t.length>s;s++)(_.isUndefined(t[s])||""===t[s])&&(t[s]=null);
r[n[e]]=t})}return{columns:n,data:r}}})}(this,_),function(t,_){var e=t.Miso.Dataset;e.Parsers.Delimited=function(t){t=t||{},this.delimiter=t.delimiter||",",this.skipRows=t.skipRows||0,this.emptyValue=t.emptyValue||null,this.__delimiterPatterns=RegExp("(\\"+this.delimiter+"|\\r?\\n|\\r|^)"+'(?:"([^"]*(?:""[^"]*)*)"|'+'([^"\\'+this.delimiter+"\\r\\n]*))","gi")},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),_.extend(e.Parsers.Delimited.prototype,e.Parsers.prototype,{parse:function(t){var e=[],n={},i={},r=function(t){i[t]||(i[t]=0);var e=t+i[t];return i[t]+=1,e},s=function(t,i,s,o,a){function u(t){var i=t[1];if(i.length&&i!==s){if(f++,h-1>d)throw f--,Error("Not enough items in row");l=!0,d=0}else l||h++,d++;var o=null;if(o=t[2]?t[2].replace(RegExp('""',"g"),'"'):t[3],l){if(""===o&&(o=a),n[e[d]]===void 0)throw Error("Too many items in row");n[e[d]].push(o)}else{var u=function(t){for(var n=r(t);-1!==e.indexOf(n);)n=r(t);return n};(_.isUndefined(o)||""===o)&&(o="X"),-1!==e.indexOf(o)&&(o=u(o)),e.push(o),n[o]=[]}}s=s||",";var c=null,h=0,l=!1,d=-1,f=0;try{if(i=i.replace(/\s+$/,"").replace(/^[\r|\n|\s]+[\r|\n]/,"\n"),o>0){for(var p=0,m=0,y=i.length;o>p&&y>m;)/\n|\r|\r\n/.test(i.charAt(m))&&p++,m++;i=i.slice(m,y)}for(RegExp("^"+s).test(i)&&u(["","",void 0,""]);c=t.exec(i);)u(c)}catch(v){throw Error("Error while parsing delimited data on row "+f+". Message: "+v.message)}return{columns:e,data:n}};return s(this.__delimiterPatterns,t,this.delimiter,this.skipRows,this.emptyValue)}})}(this,_),function(t,_){var e=t.Miso||(t.Miso={}),n=e.Dataset;n.Derived=function(t){t=t||{},n.call(this),this.parent=t.parent,this.idAttribute="_id",this.method=t.method,this._addIdColumn(),this.addColumn({name:"_oids",type:"mixed"}),this.parent.syncable&&(_.extend(this,e.Events),this.syncable=!0,this.parent.subscribe("change",this._sync,{context:this}))},n.Derived.prototype=new n,_.extend(n.Derived.prototype,{_sync:function(){this.func.call(this.args),this.publish("change")}}),_.extend(n.DataView.prototype,{movingAverage:function(t,e,i){i=i||{};var r=new n.Derived({parent:this,method:i.method||_.mean,size:e,args:arguments});this.eachColumn(function(t){if(t===this.idAttribute)throw"You can't compute a moving average on the id column";r.addColumn({name:t,type:this.column(t).type,data:[]})},this),n.Builder.cacheColumns(r);var s=function(){"string"==typeof t&&(t=[t]),this.column(this.idAttribute).data=this.parent.column(this.parent.idAttribute).data.slice(e-1,this.parent.length),this.eachColumn(function(n,i){i.data=-1===t.indexOf(n)&&"_oids"!==n?this.parent.column(n).data.slice(e-1,this.parent.length):_.movingAvg(this.parent.column(n).data,e,this.method)},this),this.length=this.parent.length-e+1;var i=this.column("_oids");i.data=[];for(var r=0;this.length>r;r++)i.data.push(this.parent.column(this.parent.idAttribute).data.slice(r,r+e));return n.Builder.cacheRows(this),this};return r.func=_.bind(s,r),r.func.call(r.args)},countBy:function(t,e){function i(t,e,i){var r;for(r=0;t.length>r;r++)if(0===n.types[i].compare(t[r],e))return r;return-1}e=e||{};var r=new n.Derived({parent:this,method:_.sum,args:arguments}),s=this.column(t);r.addColumn({name:t,type:s.type}),r.addColumn({name:"count",type:"number"}),r.addColumn({name:"_oids",type:"mixed"}),n.Builder.cacheColumns(r);var o=r.column(t).data,a=r.column("count").data,u=r.column("_oids").data,c=r.column(r.idAttribute).data;return this.each(function(e){var n=i(o,e[t],s.type);-1===n?(o.push(e[t]),c.push(_.uniqueId()),a.push(1),u.push([e[this.parent.idAttribute]])):(a[n]+=1,u[n].push(e[this.parent.idAttribute]))},r),n.Builder.cacheRows(r),r},groupBy:function(t,e,i){i=i||{};var r=new n.Derived({parent:this,method:i.method||_.sum,args:arguments});i&&i.preprocess&&(r.preprocess=i.preprocess);var s=_.union([t],e);_.each(s,function(t){this.addColumn({name:t,type:this.parent.column(t).type})},r),n.Builder.cacheColumns(r);var o=function(){var i=this;n.Builder.clearRowCache(this);for(var r={},s=0,o=this.parent.column(t),a=0;this.parent.length>a;a++){var u=null;u=this.preprocess?this.preprocess(o.data[a]):o.data[a],_.isUndefined(r[u])&&(r[u]=s,_.each(e,function(t){var e=this.column(t),n=this.column(this.idAttribute);e.data[s]=[],n.data[s]=_.uniqueId()},this),this.column(t).data[s]=u,s++),_.each(e,function(t){var e=this.column(t),n=r[u];e.data[n].push(this.parent.rowByPosition(a))},this)}var c=this._columns[this._columnPositionByName._oids];return c.data=[],_.each(e,function(t){var e=this.column(t);_.each(e.data,function(n,r){_.isArray(n)&&(c.data[r]=c.data[r]||[],c.data[r].push(_.map(n,function(t){return t[i.parent.idAttribute]})),c.data[r]=_.flatten(c.data[r]),e.data[r]=this.method(_.map(n,function(e){return e[t]})),this.length++)},this)},this),n.Builder.cacheRows(this),this};return r.func=_.bind(o,r),r.func.call(r.args)}})}(this,_);